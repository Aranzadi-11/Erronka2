package erronka3;

import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class PDFSortzailea {
    public static void mostrarFormulario() {
        JFrame frame = new JFrame("PDF Sortu - Erreserbak");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        frame.setLayout(new BorderLayout());
        
        JPanel panel = new JPanel(new GridBagLayout());
        panel.setBackground(Color.WHITE);
        GridBagConstraints gbc = new GridBagConstraints();
        gbc.insets = new Insets(5,5,5,5);
        gbc.fill = GridBagConstraints.HORIZONTAL;
        
        // Kombobox logelarako: "izena" lortu logelak taulatik
        gbc.gridx = 0; gbc.gridy = 0;
        panel.add(new JLabel("Logela (Izena):"), gbc);
        gbc.gridx = 1;
        JComboBox<String> logelaCombo = new JComboBox<>(DBAukerak.getLogelaIzenaArray());
        panel.add(logelaCombo, gbc);
        
        // Kombobox bezeroarako: "erabiltzaileIzena", filtratuz logelaren arabera
        gbc.gridx = 0; gbc.gridy = 1;
        panel.add(new JLabel("Bezeroa (Erabiltzaile Izena):"), gbc);
        gbc.gridx = 1;
        JComboBox<String> bezeroCombo = new JComboBox<>(new String[]{});
        panel.add(bezeroCombo, gbc);
        
        // Kombobox data: erreserba datak
        gbc.gridx = 0; gbc.gridy = 2;
        panel.add(new JLabel("Data:"), gbc);
        gbc.gridx = 1;
        JComboBox<String> dataCombo = new JComboBox<>(new String[]{});
        panel.add(dataCombo, gbc);
        
        // Logela aukeratuenean, bezeroak eguneratu
        logelaCombo.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent e) {
                String logelaIzena = (String) logelaCombo.getSelectedItem();
                String[] bezeroak = DBAukerak.getBezeroErreserbatuArray(logelaIzena);
                bezeroCombo.setModel(new DefaultComboBoxModel<>(bezeroak));
            }
        });
        
        // Bezero aukeratuenean, datak eguneratu
        bezeroCombo.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent e) {
                String logelaIzena = (String) logelaCombo.getSelectedItem();
                String bezeroIzena = (String) bezeroCombo.getSelectedItem();
                String[] datak = DBAukerak.getErreserbaDataArray(logelaIzena, bezeroIzena);
                dataCombo.setModel(new DefaultComboBoxModel<>(datak));
            }
        });
        
        JPanel buttonPanel = new JPanel();
        buttonPanel.setBackground(Color.WHITE);
        JButton sortuButton = new JButton("Sortu PDF");
        JButton ezeztatuButton = new JButton("Ezeztatu");
        buttonPanel.add(sortuButton);
        buttonPanel.add(ezeztatuButton);
        
        sortuButton.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent e) {
                // PDF sortzea simulatuko dugu (libreria espezifikoa erabilita lortuko litzateke)
                JOptionPane.showMessageDialog(null, "PDF-a sortuta!", "Info", JOptionPane.INFORMATION_MESSAGE);
                frame.dispose();
            }
        });
        
        ezeztatuButton.addActionListener(new ActionListener(){
            public void actionPerformed(ActionEvent e) {
                frame.dispose();
            }
        });
        
        frame.add(panel, BorderLayout.CENTER);
        frame.add(buttonPanel, BorderLayout.SOUTH);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
}
